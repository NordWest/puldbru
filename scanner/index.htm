<html>

<head>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=windows-1251">
</head>

<body>

<!------------------------------------------------------------------------->
<h2 align="center">Инструкция по измерению пластинок<br>при помощи сканера</h2>

<hr width ="50%">

<h3> Глава 1. Общие рекомендации </h3>
<b>ВНИМАНИЕ: во время сканирования (когда сканер жужжит) не рекомендуется:
<ul type="square">
   <li>    Трогать сканер
   <li>    Толкать стол, на котором стоит сканер
   <li>    Запускать другие программы на компьютере, к которому подключен сканер
   <li>    Топать ногами возле стола, на котором стоит сканер.
</ul>
   Вышеперечисленные действия могут негативно отразиться на точности 
   измерений. Так что лучше во время сканирования вообще уйдите в соседнюю комнату.

        <p>Также нежелательно, чтобы во время сканирования к порту USB были
        подключены какие-либо устройства, помимо сканера (например: внешний 
        винчестер, Flash Drive и т.п.). Если вы хотите записать сканы на внешний винчестер,
        подключайте его ПОСЛЕ того, как закончите сканирование.
</b>

<p>Для сканирования пластинок мною было разработано и изготовлено специальное
приспособление, условно называемое "рамка". Рамка представляет собой нечто
вроде квадратного бумажного конверта размером 165х165мм, посередине которого 
имеется квадратное окно размером 135х135мм. Пластинка помещается внутрь рамки.
Края пластинки оказываются закрыты бумагой, а середина открыта для 
сканирования.
<p>Для чего нужна рамка:
<p>1) Если класть пластинку прямо на стекло сканера (без рамки), то пылинки,
попадающие между стеклом и пластинкой, оставляют микроцарапины как на стекле,
так и на пластинке. Это очень плохо. При использовании рамки между 
пластинкой и стеклом создается зазор толщиной порядка 0.1мм. Благодаря
этому удается избежать появления микроцарапин.
<p>2) Если класть пластинку прямо на стекло сканера (без рамки), коэффициент 
трения между стеклом и пластинкой будет небольшой. Из-за этого, когда вы
задвигаете "поднос" (т.е. держатель стекла) внутрь сканера, пластинка может 
съехать с того места, куда вы ее положили. Это тоже очень плохо. При 
использовании рамки  коэффициент трения между стеклом и пластинкой будет
больше, благодаря чему удается избежать нежелательных сдвигов пластинки.
<b>
<p>ВНИМАНИЕ: Убедительная просьба обращаться  с рамкой предельно осторожно. Это 
довольно хрупкая вещь, ее легко порвать или помять. Тот, кто порвет
рамку, будет делать новую сам. А делать ее довольно трудно - работа тонкая и кропотливая.
</b>
<p>Рекомендую хранить рамку под верхней крышкой сканера - там она никуда
не потеряется.
<p>В программе для сканирования НЕ РЕКОМЕНДУЮ нажимать кнопку "Prescan".
Если вы все-таки не удержались и нажали эту кнопку, то нажмите после
этого "Overview" чтобы восстановить масштаб.
<p>Рекомендую для каждой пластинки создавать новый каталог на винчестере,
а не сваливать все сканы в один и тот же каталог.
<!------------------------------------------------------------------------->
<hr width ="50%">
<h3> Глава 2. Как правильно сканировать пластинки </h3>

<ol>
   <li> Включите сканер.
   <li> Включите компьютер.
   <li> Подождите, пока загрузится Windows.
   <li> Подождите 5 минут - чтобы прогрелась ПЗС-линейка.
   <li> Запустите программу Microtek ScanWizard
   <li> Убедитесь, что в программе установлены правильные настройки (см. рис. 1)
   <li> Убедитесь, что мигающая рамка (выбор области сканирования) расположена как 
        на рис. 2 (особенно левый верхний угол)
   <li> Нажмите кнопку "Overview" (не "Prescan" !!!). Сканер начнет жужжать. Подождите, пока сканер 
   перестанет жужжать.
   <li> Повторите предыдущий пункт 3-5 раз. Это необходимо для того, чтобы 
   прогрелась механика сканера.
   <li> Поместите пластинку в бумажную рамку.

   <hr width ="50%">
   <li> Вытащите "поднос" (держатель стекла) из сканера.
   <li> Положите пластинку так, как показано на рис.3, <b>эмульсией вниз</b>, севером от себя,
   югом к себе.
   <li> Задвиньте "поднос" в сканер.
   <li> Задвигайте "поднос" осторожно, так чтобы пластинка не съехала
   <li> На всякий случай можно открыть верхнюю крышку сканера и убедиться, не
        съехала ли пластинка. Не забудьте после этого закрыть верхнюю крышку.
   <li> Допускается случайный поворот пластинки на угол до 5<sup>o</sup> и сдвиг на расстояние 
        до 10-15 мм.
   <li> Нажмите кнопку "Batch" (см. рис. 2). Сохраните скан под именем <code>n.tif</code>. Нажмите кнопку "Done".
   <li> Пока идет сканирование, соблюдайте меры предосторожности, указанные в
   предыдущем параграфе.
   <li> Нажмите кнопку "Done". 

   <hr width ="50%">
   <li> Повторите пункты 11-19, но только кладите пластинку югом от себя.
        Сохраните скан под именем <code>s.tif</code>.

   <li> Повторите пункты 11-19, но только кладите пластинку востоком от себя.
        Сохраните скан под именем <code>e.tif</code>.

   <li> Повторите пункты 11-19, но только кладите пластинку западом от себя.
        Сохраните скан под именем <code>w.tif</code>.
</ol>

<!------------------------------------------------------------------------->
<hr width ="50%">
<h3> Глава 3. Как правильно измерять пластинки </h3>

<ol>
   <li> Запустите программу FAR.
   <li> Зайдите в тот каталог, куда вы сохранили сканы.
   <li> Наберите на клавиатуре команду:
        <br><code>measure N</code><br>
        Вместо буквы N следует указать количество экспозиций на пластинке, например:
        <br><code>measure 3</code><br>
   <li> Нажмите клавишу Enter.
   <li> Программа будет работать 40-50 минут.
   <li> В результате вы получите такие файлы:
        <ul type="square">
        <li> <code>raw.arj</code>   - этот файл содержит "сырые" координаты
             (то есть, не усредненные по экспозициям).
        <li> <code>average.arj</code> - этот файл содержит координаты, 
             усредненные по экспозициям. 
        </ul>
        Они используются для дальнейшей обработки.
        Переименуйте эти файлы в соответствии с номером пластинки.<br>
        Например: <code>12345-average.arj</code> и <code>12345-raw.arj</code>.
</ol>

<!------------------------------------------------------------------------->
<hr width ="50%">
<h3> Глава 4. Как делать редукцию систематической ошибки сканера</h3>
<p> Допустим, ваш файл с <b>усредненными</b> координатами называется <code>12345-average.arj</code>
(у вас он будет называться по-другому, см. предыдущую главу).
<ol>
   <li> Запустите программу FAR.
   <li> Зайдите в тот каталог, где находится ваш файл с усредненными координатами.
   <li> Наберите на клавиатуре команду:
        <br><code>start4   filename.arj</code><br>
        Вместо "filename.arj" следует указать имя вашего файла с усредненными координатами, например:
        <br><code>start4   12345-average.arj</code><br>
   <li> Нажмите клавишу Enter.
   <li> Программа будет работать порядка одной минуты.
   <li> В результате вы получите такие файлы:
        <ul type="square">
        <li> <code>12345-average.arj.v21</code>
        <li> <code>12345-average.arj.v22</code>
        <li> <code>12345-average.arj.v23</code>
        </ul>
        Эти файлы содержат координаты, исправленные за систематическую ошибку сканера.
        Каждый файл соответствует своей версии редукционных программ (21, 22 и 23).
        Вам следует обработать все эти файлы и выбрать тот, который дает лучшие результаты.
        Описание формата данных см. далее.
   <li> Также там появится файл <code>12345-average.arj.log</code>. В случае возникновения каких-либо проблем,
        этот файл можно выслать мне по почте.
</ol>

<!------------------------------------------------------------------------->
<hr width ="50%">
<h3> Приложение 1. Oписание формата данных </h3>
<pre>
 Каждая строка соответствует одной звезде.
 В каждой строке - 5 чисел.
 1) интегральная оптическая плотность изображения звезды
 2) координата X центра изображения звезды (в пикселах, 1 пиксел = 8 микрон)   
 3) координата Y центра изображения звезды (в пикселах, 1 пиксел = 8 микрон)   
 4) количество пикселей, занимаемых изображением звезды 
 5) пиковая оптическая плотность изображения звезды
Ось X направлена на запад.
Ось Y направлена на север.
</pre>

<!------------------------------------------------------------------------->
<hr width ="50%">
<h3> Приложение 2. Программное обеспечение </h3>
<ul type="square">
   <li> Программы, используемые для измерений и редукции, 
        должны быть установлены в каталог <code>c:\scansoft</code>.
        <b>В другом каталоге и/или на другом диске программы работать не будут.</b>
   <li> В файле <code>c:\autoexec.bat</code> должна содержаться следующая строка:
        <br><code>set path=%path%;c:\scansoft</code>
   <li> Список файлов, которые должны присутствовать в каталоге <code>c:\scansoft</code>:
   <pre>
3200.dxdy   - файл с калибровочными поправками
MEASURE.BAT - скрипт для измерения сканов
START4.BAT  - скрипт для редукции систематической ошибки (ВАРИАНТ 1)
RAW4.BAT    - скрипт для редукции систематической ошибки (ВАРИАНТ 2)
CMP4.BAT    - вспомогательный скрипт (сортирует звезды)
LIN4.BAT    - вспомогательный скрипт (прибавляет калибровочные поправки)
3SIGMA4.BAT - вспомогательный скрипт (делает 3-сигма-фильтрацию)
NSEW4.BAT   - вспомогательный скрипт (усредняет 4 скана)
lorentz.exe      - вспомогательная программа (измеряет звезды)
aver-exp.exe     - вспомогательная программа (усредняет экспозиции)
cmp-raw.exe      - вспомогательная программа (сортирует звезды)
180.exe          - вспомогательная программа (усредняет 2 скана)
90.exe           - вспомогательная программа (усредняет 2 скана)
find3s.exe       - вспомогательная программа (делает 3-сигма-фильтрацию)
clear3s.exe      - вспомогательная программа (делает 3-сигма-фильтрацию)
lin.exe          - вспомогательная программа (прибавляет калибровочные поправки)
shiftx-lin.exe   - вспомогательная программа (оценивает внутреннюю сходимость)
plate-center.exe - вспомогательная программа (центрирует пластинку)
arj.exe          - вспомогательная программа (архиватор, автор: Роберт Джанг)
   </pre>
   <li> Исходные тексты моих программ можно найти <a href="scansoft.tgz">здесь</a>.
        Для их компилирования нужна библиотека GSL (GNU Scientific Library).
</ul>


<!------------------------------------------------------------------------->
<hr width ="50%">
<!-------------------------------->
<table border="0" align="center">
   <tr>
      <td valign="center" align="center">
      <img src="manual-fig1.jpg">
      </td>
   </tr>
   <tr>
      <td valign="center" align="center">
      Рис.1. Настройки
      </td>
   </tr>
</table>

<!------------------------------------------------------------------------->
<hr width ="50%">
<!-------------------------------->
<table border="0" align="center">
   <tr>
      <td valign="center" align="center">
      <img src="manual-fig2.jpg">
      </td>
   </tr>
   <tr>
      <td valign="center" align="center">
      Рис.2. Выбор области сканирования
      </td>
   </tr>
</table>

<!------------------------------------------------------------------------->
<hr width ="50%">
<!-------------------------------->
<table border="0" align="center">
   <tr>
      <td valign="center" align="center">
      <img src="manual-fig3.gif">
      </td>
   </tr>
   <tr>
      <td valign="center" align="center">
      Рис.3. Размещение пластинки
      </td>
   </tr>
</table>

<!------------------------------------------------------------------------->
<hr width ="50%">

</body>

</html>
