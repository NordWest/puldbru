<html>

<head>
</head>

<body>

<!------------------------------------------------------------------------->
<h1> Использование планшетного сканера для проведения астрометрических
измерений фотопластинок: новый метод калибровки </h1>
<h2> Хруцкая Е.В., Калинин С.И. </h2>
<!------------------------------------------------------------------------->
<p> Разработанный нами метод калибровки основан на методе, описанном в работе [1].
Последний использовался для калибровки измерительной машины SuperCOSMOS 
(Эдинбургская Королевская Обсерватория, Великобритания).
Сначала мы попытались произвести калибровку согласно методу [1], но, к
сожалению, он не дал хороших результатов. Возможно, это связано с тем, что
систематическая ошибка сканера превосходит систематическую ошибку машины 
SuperCOSMOS в несколько десятков раз. Поэтому мы решили разработать новый метод,
который представляет собой усовершенствованный и обобщенный вариант метода [1]. 
<!------------------------------------------------------------------------->
<h3> Технические характеристики сканера </h3>
<ul>
<li> оптическое разрешение: 3200 dpi
<li> количество бит на пиксел (при черно-белом сканировании): 16
<li> размер области сканирования (для прозрачных материалов): 200x250 мм
<li> время сканирования пластинки размером 160x160 мм (3200 dpi, 16 bpp): 
     примерно 5 мин.
<li> интерфейс: USB 2.0
</ul>
<!------------------------------------------------------------------------->
<h3>Вычисление поправок за систематическую ошибку</h3>
<p> Пусть (<i>x</i>,<i>y</i>) - измеренные с помощью сканера прямоугольные координаты звезды
(в системе координат, связанной со сканером). Координаты (<i>x</i>,<i>y</i>) содержат в
себе систематические и случайные ошибки. Пусть (<font face="symbol">x</font>,<font face="symbol">h</font>) - истинные (т.е.
свободные от ошибок) координаты этой же звезды в той же системе координат.
Представим истинные координаты (<font face="symbol">x</font>,<font face="symbol">h</font>) в виде суммы измеренных координат
(<i>x</i>,<i>y</i>) и некоторых неизвестных поправок <i>e<sub>x</sub></i>(<i>x</i>,<i>y</i>) и <i>e<sub>y</sub></i>(<i>x</i>,<i>y</i>):

<table border="0" align="center">
   <tr>
      <td valign="center">
         <font face="symbol">x</font>  = <i>x</i> + <i>e<sub>x</sub></i>(<i>x</i>,<i>y</i>)
         <br>
         <font face="symbol">h</font> = <i>y</i> + <i>e<sub>y</sub></i>(<i>x</i>,<i>y</i>)
      </td>
      <td valign="center"> (1) </td>
   </tr>
</table>

<p> Случайную ошибку мы здесь не будем учитывать для упрощения уравнений.
<p> Мысленно разделим область сканирования (стекло сканера, на которое
кладется пластинка) на квадраты, образующие сетку из <i>M</i> рядов и <i>M</i> столбцов,
(т.к. стекло имеет прямоугольную форму, то часть стекла остается не
разделенной на квадраты, см. рис. 1).

<table border="0" align="center">
   <tr>
      <td valign="center">
      <img src="fig1.gif">
      </td>
   </tr>
   <tr>
      <td valign="center">
      Рис.1. Разбиение области сканирования на квадраты.
      </td>
   </tr>
</table>

<p> Представим поправки <i>e<sub>x</sub></i>(<i>x</i>,<i>y</i>) и <i>e<sub>y</sub></i>(<i>x</i>,<i>y</i>) в следующем виде:

<table border="0" align="center">
   <tr>
      <td valign="center">
         <i>e<sub>x</sub></i>(<i>x</i>,<i>y</i>) = <i>f</i>(<i>m</i>)
         <br>
         <i>e<sub>y</sub></i>(<i>x</i>,<i>y</i>) = <i>g</i>(<i>m</i>)
      </td>
      <td valign="center"> (2) </td>
   </tr>
</table>

<p> где <i>m</i> - номер квадрата, в котором находится звезда (<i>m</i> - целое число от
1 до <i>M<sup>2</sup></i>). Таким образом, функции <i>f</i> и <i>g</i> заданы на множестве целых чисел от 1
до <i>M<sup>2</sup></i> и имеют по <i>M<sup>2</sup></i> дискретных значений. То есть, количество неизвестных
калибровочных поправок равно 2<i>M<sup>2</sup></i>.
<p> Вычисление поправок производится по следующему алгоритму:
<p> 1) Отсканируем пластинку несколько раз с поворотом на разные углы,
        кратные 90<sup>o</sup>, и сдвигами на произвольные расстояния.
<p> 2) Измерим все звезды на всех сканах. Обращаем ваше внимание на то, что
        система координат связана со сканером, а не с пластинкой (см. рис. 1).
<p> 3) Выберем произвольно одну пару сканов из этого набора. Обозначим эти 
        сканы <i>A</i> и <i>B</i>. Используя нелинейный МНК, вычислим:
        <br> <font face="symbol">a</font> - угол поворота пластинки между сканами <i>A</i> и <i>B</i>.
        <br> <i>S<sub>x</sub></i> - сдвиг пластинки вдоль оси <i>x</i> между сканами <i>A</i> и <i>B</i>.
        <br> <i>S<sub>y</sub></i> - сдвиг пластинки вдоль оси <i>y</i> между сканами <i>A</i> и <i>B</i>.
        <br> Таким образом, координаты звезд на сканах <i>A</i> и <i>B</i> связаны следующими
        уравнениями:

<table border="0" align="center">
   <tr>
      <td valign="center">
         <i>x</i><i><sub>kB</sub></i> = <i>x</i><i><sub>kA</sub></i>cos<font face="symbol">a</font> + <i>y</i><i><sub>kA</sub></i>sin<font face="symbol">a</font> + <i>S<sub>x</sub></i> + <i>R<sub>xk</sub></i>
         <br>
         <i>y</i><i><sub>kB</sub></i> = <i>y</i><i><sub>kA</sub></i>cos<font face="symbol">a</font> - <i>x</i><i><sub>kA</sub></i>sin<font face="symbol">a</font> + <i>S<sub>y</sub></i> + <i>R<sub>yk</sub></i>
      </td>
      <td valign="center"> (3) </td>
   </tr>
</table>

где:
<br> <i>k</i> - номер звезды, <i>k</i> = 1, ..., <i>N<sub>stars</sub></i>.
<br> <i>x</i><i><sub>kA</sub></i> - координата <i>x</i> звезды <i>k</i> на скане <i>A</i>.
<br> <i>y</i><i><sub>kA</sub></i> - координата <i>y</i> звезды <i>k</i> на скане <i>A</i>.
<br> <i>x</i><i><sub>kB</sub></i> - координата <i>x</i> звезды <i>k</i> на скане <i>B</i>.
<br> <i>y</i><i><sub>kB</sub></i> - координата <i>y</i> звезды <i>k</i> на скане <i>B</i>.
<br> <i>R<sub>xk</sub></i> и <i>R<sub>yk</sub></i> - невязки, возникающие из-за случайных и систематических ошибок
измерений. Если бы сканер не вносил ошибки в измерения, то <i>R<sub>xk</sub></i> и <i>R<sub>yk</sub></i> были бы
равны нулю. Обозначим такие координаты (свободные от ошибок) буквами
<font face="symbol">x</font> и <font face="symbol">h</font>; тогда можно переписать уравнения (3) в следующем виде:

<table border="0" align="center">
   <tr>
      <td valign="center">
         <font face="symbol">x</font><i><sub>kB</sub></i>  = <font face="symbol">x</font><i><sub>kA</sub></i>cos<font face="symbol">a</font>  + <font face="symbol">h</font><i><sub>kA</sub></i>sin<font face="symbol">a</font> + <i>S<sub>x</sub></i> 
         <br>
         <font face="symbol">h</font><i><sub>kB</sub></i> = <font face="symbol">h</font><i><sub>kA</sub></i>cos<font face="symbol">a</font> - <font face="symbol">x</font><i><sub>kA</sub></i>sin<font face="symbol">a</font>  + <i>S<sub>y</sub></i> 
      </td>
      <td valign="center"> (4) </td>
   </tr>
</table>

<br> Объединяя уравнения (1), (2) и (4), получим:

<table border="0" align="center">
   <tr>
      <td valign="center">
         <i>f</i>(<i>m</i><i><sub>kA</sub></i>)cos<font face="symbol">a</font> +
         <i>g</i>(<i>m</i><i><sub>kA</sub></i>)sin<font face="symbol">a</font> -
         <i>f</i>(<i>m</i><i><sub>kB</sub></i>)
         = <i>x</i><i><sub>kB</sub></i> - <i>x</i><i><sub>kA</sub></i>cos<font face="symbol">a</font> - <i>y</i><i><sub>kA</sub></i>sin<font face="symbol">a</font> - <i>S<sub>x</sub></i>
         <br>
         <i>g</i>(<i>m</i><i><sub>kA</sub></i>)cos<font face="symbol">a</font> -
         <i>f</i>(<i>m</i><i><sub>kA</sub></i>)sin<font face="symbol">a</font> -
         <i>g</i>(<i>m</i><i><sub>kB</sub></i>)
         = <i>y</i><i><sub>kB</sub></i> - <i>y</i><i><sub>kA</sub></i>cos<font face="symbol">a</font> + <i>x</i><i><sub>kA</sub></i>sin<font face="symbol">a</font> - <i>S<sub>y</sub></i> 
      </td>
      <td valign="center"> (5) </td>
   </tr>
</table>

<br> где:
<br> <i>m</i><i><sub>kA</sub></i> - номер квадрата, в котором находится звезда <i>k</i> на скане <i>A</i>.
<br> <i>m</i><i><sub>kB</sub></i> - номер квадрата, в котором находится звезда <i>k</i> на скане <i>B</i>.

<br> В правой части уравнений (5) находятся известные величины,
в левой части - неизвестные поправки <i>f</i>(<i>m</i>) и <i>g</i>(<i>m</i>). Таким образом,
каждая звезда дает 2 уравнения; одна пара сканов дает 2<i>N<sub>stars</sub></i> уравнений.
Пока эти уравнения решать не надо.

<p> 4) Повторим пункт 3) для каждой пары сканов, добавляя  полученные
      уравнения в одну общую систему.
      
<p> 5) В результате получим систему из 2<i>N<sub>stars</sub></i><i>N<sub>pairs</sub></i> уравнений с 2<i>M<sup>2</sup></i> 
       неизвестными (в нашем случае было около 300000 уравнений с 2048 
       неизвестными). Решая эту систему по МНК, получим калибровочные поправки
       <i>f</i>(<i>m</i>) и <i>g</i>(<i>m</i>).

<!------------------------------------------------------------------------->
<h3> Проверка величины остаточной систематической ошибки </h3>
<p> Для проверки величины остаточной систематической ошибки использовались
два независимых метода:
<ol> 
<li> Первый метод основан на сохранении расстояний между звездами при поворотах
   и сдвигах пластинки в сканере.
<li> Второй метод основан на приведении двух сканов к одной системе координат
   и вычислении сдвигов звезд.
</ol> 
Вкратце опишем эти методы:
<ol> 
<li>  Отсканируем пластинку два раза с поворотом на 180<sup>o</sup> и (возможно) сдвигом
    на некоторое расстояние. Измерим все звезды на этих сканах. Очевидно, 
    что если бы у сканера не было систематических и случайных ошибок, 
    то расстояния между звездами на первом скане равнялись бы расстояниям
    между этими же звездами на втором скане. На практике эти расстояния
    различаются на некоторую величину. Эта величина и характеризует
    величину остаточной систематической ошибки.
<li>  Отсканируем пластинку два раза с поворотом на 180<sup>o</sup> и (возможно) сдвигом
    на некоторое расстояние. Измерим все звезды на этих сканах. 
    Обозначим эти сканы <i>A</i> и <i>B</i>. Используя нелинейный МНК, вычислим:
        <br> <font face="symbol">a</font> - угол поворота пластинки между сканами <i>A</i> и <i>B</i>.
        <br> <i>S<sub>x</sub></i> - сдвиг пластинки вдоль оси <i>x</i> между сканами <i>A</i> и <i>B</i>.
        <br> <i>S<sub>y</sub></i> - сдвиг пластинки вдоль оси <i>y</i> между сканами <i>A</i> и <i>B</i>.
    <br> Приведем координаты всех звезд на скане <i>B</i> к системе координат скана <i>A</i>.
    Очевидно, что если бы у сканера не было систематических и случайных ошибок, 
    то координаты звезд на обоих сканах после приведения совпали бы идеально.
    На практике координаты не совпадают, и у каждой звезды есть сдвиги по 
    осям <i>x</i> и <i>y</i>. Эти сдвиги характеризуют величину остаточной 
    систематической ошибки.
</ol> 
<p> Первый метод показывает величину остаточной систематической ошибки
   порядка 1.0-1.5 микрон. Графики, полученные с помощью второго метода, также 
   соответствуют этой величине (см. рис. 2).

<!------------------------------------------------------------------------->
<table border="0" align="center">
   <tr>
      <td valign="center">
      <img src="fig2A.gif">
      </td>
   </tr>
   <tr>
      <td valign="center">
      <img src="fig2B.gif">
      </td>
   </tr>
   <tr>
      <td valign="center">
      Рис.2. Сдвиги звезд, полученные при сравнении 2х сканов (сделанных 
      с поворотом пластинки на 180<sup>o</sup>) <b> после </b> учета поправок за 
      систематическую ошибку.
      </td>
   </tr>
</table>
<!------------------------------------------------------------------------->
<h3> Литература </h3>
<ol>
<li> "Precision astrometry with SuperCOSMOS", Hambly N.C. et al. //
MNRAS 298, 1998, pp. 897-904
</ol>
<hr>

</body>
</html>
